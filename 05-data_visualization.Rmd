# Data Visualization
## Basic Data Visualization
### Introduction to ggplot2
![](images/ggplot.png)

This is package designed for data visualization. It provides a powerful and flexible framework for creating complex and aesthetically pleasing visualizations, allowing users to layer various components such as axes, scales, colors, and geoms to create detailed and customizable plots. 

The package is said that it implements the principle of "Grammar of Graphics". The "Grammar of Graphics" is a conceptual framework for creating graphs by Leland Wilkinson. The process of creating graphs is broken into fundamental components. This allows structure and flexible approach in data visualization. The plots are constructed by a layered approach by implementing these concepts step by step; data, aesthetics(`aes`), geometrics(`geoms`), statistical transformations (`stats`), scales, cordinates and facets.  

The package is also under the `tidyverse` package but can be installed by
```
install.packages("ggplot2")
```
Once the package is installed, it can be loaded by
```
library(ggplot2)
```

There are 5 key steps in plotting in ggplot;
<p>
  1.**The Setup** - Read the data set, define x and y axis 
  
  2. **The Labels** - Title, X and Y axis labels 
  
  3. **The Theme** - Default, Black and White, colored etc. 
  
  4. **The Facets** - Individual Graphs for each group in data with exactly same range
  
  5. **The Layers or geoms** - The actual plot type - e.g Bar plot, Box plot, Violin plot etc. 
</p>

Here is an example of a layered approach in creating charts by applying the "Grammar of Graphics". 

```{r}
library(ggplot2)

# Sample data
df <- data.frame(
  x = rnorm(100),
  y = rnorm(100),
  category = sample(c("A", "B"), 100, replace = TRUE)
)

# Creating a scatter plot
ggplot(df, # data
       aes(x = x, y = y, color = category)) + #aesthetics
  geom_point() + #geometrics
  labs(title = "Scatter Plot Example", x = "X-Axis", y = "Y-Axis") +
  theme_minimal()
```

#### Creating Basic Plots
- **Scatter Plots**  

Scatter plot is used to show a numerical relationship between two or more variables for instance height versus weight of footballers. It is also used to detect correlation, the increase in one variable can lead to increase/decrease of another variable. Furthermore scatter plots are used to detect outliers, values that appear out of the general patterns of other data points is said to be an outlier in this case. However, scatter plots is not suitable when working with categorical data especially when only two variables are to be analyzed.

Lets create a basic scatter plot to compare height and weight;-

```{r}
#Prepare a Sample data
df <- data.frame(
  height = c(150, 160, 170, 180, 190),
  weight = c(50, 60, 70, 80, 90)
)

# Creating a basic scatter plot
ggplot(df, # data
       aes(x = height, y = weight)) + # aesthetics
  geom_point() 
```
To make the chart more informative, titles and labels are added. 

```{r}
# Creating a basic scatter plot
ggplot(df, # data
       aes(x = height, y = weight)) + # aesthetics
  geom_point() +
  labs(title = "Height vs. Weight", x = "Height (cm)", y = "Weight (kg)") +
  theme_minimal()

```

Lets explain the chart step by step;- 

- `ggplot(df, aes(x = height, y = weight))`: Initializes the ggplot object, specifying the data frame (`df`) and mapping the `height` variable to the x-axis and the `weight` variable to the y-axis using the `aes()` function.
- `geom_point()`: Creates the scatter plots by adding dots to the chart
- `labs()`: Adds the title and the axis labels to the chart. 
- `theme_minimal()`: Applies a minimal theme to the plot for a minimalist and clean appearance.

<-**Practical exercise: Creating scatter plots for different datasets**->

- **Bar Charts**

Bar charts are used to represent both categorical and numeric data in form of rectangular bars. The length/height of each category represents its numeric value. It may corresponds to either length, count, age or any other numerical value. Bar charts are used when;- 

i. Comparing categorical data
ii. Visualizing summarized data for instance aggregated sum, average or any other summary statistics. 
iii. Showing frequency or count for instance representing the number of products sold per each category. 
iv. Ranking data. Bar charts can effectively represents ranks especially in descending/ascending order for instance ranking the life expectancy of different countries. 
v. Other type of complex bar charts like stacked bar charts can be used to compare part-to-whole relationships. 

There are many more uses of bar charts however there are some use cases where bar charts are not preferred like when working with continuous data, scatter and line charts are more befitting. Also, bar charts are not appropriate where data has too many categories, heatmaps will do better. 

To create a simple bar chart using ggplot2, we use `geom_bar` to define thats its a bar chart.

```{r}
# Sample data
df <- data.frame(
  category = c("A", "B", "C", "D"),
  value = c(23, 17, 35, 10)
)

## The data set above will be used to create a bar chart
# Creating a bar chart
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity") +
  labs(title = "Value by Category", x = "Category", y = "Value") +
  theme_minimal()
```


<-**Practical exercise: Creating bar charts for categorical data.**->

- **Histograms**

Histogram is visually similar to the bar chart however it is used show frequency and distribution across a list-like data set(vectors, lists, sets, arrays, etc) that stores continuous numeric values. The count of observation within a certain range of values are displayed. 

Lets create a vector of random 100 ages and plot the data to a histogram.

```{r}
# Generate random 1000 ages between 0 and 100
set.seed(42)
ages <- sample(0:100, 1000, replace = TRUE)

# Create a data frame to use with ggplot
age_data <- data.frame(Age = ages)

# PLOTTING
# Create the histogram using ggplot
ggplot(age_data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "black") +
  labs(title = "Histogram of Randomly Generated Ages", x = "Age", y = "Frequency") +
  theme_minimal()
```

The bins are groups of ages ranging 5 years. 

<-**Add a practical exercise**->

#### Customizing plots
- **Themes**

Themes in `ggplot2` control the overall appearance of the plot for instance the grid line, font style, background color etc. To clearly explain the `theme` concept we will create a sample data set and plot it. The theme will be altered to show the changes in the appearance. 

Create a data set and plot a basic bar plot from `ggplot2`
```{r}
# Sample data
df <- data.frame(
  category = c("A", "B", "C", "D"),
  value = c(23, 17, 35, 10)
)

# Plot a basic bar chart
# Create a basic bar plot
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity")
```

Lets apply some built-in themes from `ggplot`. In this case, we will use the `theme_minimal()`. 
```{r}
# Bar plot with theme_minimal
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity") +
  theme_minimal()
```
The `theme_minimal()` removes background colors, extra gridlines and axes' tickers to give the a chart a clean look. 

Now, lets try with the `theme_classic()`
```{r}
# Bar plot with theme_classic
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity") +
  theme_classic()
```

The `theme_classic()` gives the bar plot a clear white background, black borderline with raised 0 point on the axes and bars. 

The third theme in this course is the `theme_light()`. Lets try it with the same data set. 
```{r}
# Bar plot with theme_light
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity") +
  theme_light()
```

The `theme_light()` is gives grey gridlines, grey borderline and raised bars(not touching the axes).

The last theme in this list is the `theme_dark()`. Lets try it below here;
```{r}
# Bar plot with theme_dark
ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity") +
  theme_dark()
```
The `theme_dark()` is a clear opposite of `theme_light` as it produces a plot with a dark grid lines. 

There are more themes provided in `ggplot2` like `theme_bw()`

<-**Add a practical exercise**->

- **Labels and Titles**

The appearance of the charts can be made more appealing and informative by adding labels and titles. This can be achieved adding the function `labs` to a ready plot. 

Lets plot the same bar chart as above and add more information with labels; 
```{r}
# Create a basic bar plot
p <- ggplot(df, aes(x = category, y = value)) +
  geom_bar(stat = "identity")

p # Show the plot
```

The above chart is stored in a variable `p`. Lets add/modify the labels and titles using the `labs()` function. 
```{r}
# Bar plot with title, axis labels, and caption
p + labs(
  title = "Bar Plot of Categories",
  subtitle = "Values by Category",
  x = "Category",
  y = "Value",
  caption = "Source: Sample Data"
)

# Remember `p` is the bar plot
```

The bar plot is more informative now. Lets make the chart more appealing by modifying the appearance of the labels using the `theme()` function along with the `element_text()` function. 
```{r}
# Bar plot with customized title and labels
p + labs(
  title = "Bar Plot of Categories",
  subtitle = "Values by Category",
  x = "Category",
  y = "Value",
  caption = "Source: Sample Data"
) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    plot.subtitle = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(face = "italic", size = 12),
    axis.title.y = element_text(face = "italic", size = 12),
    plot.caption = element_text(hjust = 0, face = "italic", size = 10)
  )
```

<-**Add a practical exercise**->

- **Color and aesthetics**

The general aesthetics are essential when presenting the analysis results. They enhance the visual appearance of the charts. It also allows the users/analyst to distinguish different properties/categories in a variable. They include; color, size and shape.

Lets plot a simple bar chart and add a flavor of aesthetics. 
```{r}
# Sample data with an additional variable. Modified the original one
df <- data.frame(
  category = c("A", "B", "C", "D"),
  value = c(23, 17, 35, 10),
  group = c("G1", "G2", "G1", "G2")
)


# Bar plot with mapped color, size, and shape
ggplot(df, aes(x = category, y = value, color = group, size = value, shape = group)) +
  geom_point()
```

Lets break down the scatter plot on how aesthetics are applied. 

i. `color = group`: Maps the group variable to the color of the points. Each group will have a different color.
ii. `size = value`: Maps the value variable to the size of the points. Points with higher values will be larger.
iii. `shape = group`: Maps the group variable to the shape of the points. Different groups will have different shapes.

Above there, the color was selected automatically by R. It can also be customized to fit our taste. Lets do a bit of color customization.
```{r}
# Customizing colors manually
ggplot(df, aes(x = category, y = value, color = group)) +
  geom_point(size = 5) +
  scale_color_manual(values = c("G1" = "blue", "G2" = "red"))
```

The `scale_color_manual()` function allows you to manually set the colors for each level of the group variable. In this case, G1 is set to blue and G2 to red.

<-**add a practical exercise**-> 

## Advanced Data Visualization